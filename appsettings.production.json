{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Microsoft.EntityFrameworkCore": "Warning",
      "Naia": "Debug"
    }
  },
  "AllowedHosts": "*",
  
  "DefaultPointFilter": "*BESS*",
  "DefaultMaxPoints": 100,
  
  "ConnectionStrings": {
    "PostgreSQL": "Host=localhost;Port=5432;Database=naia;Username=naia;Password=naia_dev_password;SslMode=Disable;Pooling=false",
    "PostgreSql": "Host=localhost;Port=5432;Database=naia;Username=naia;Password=naia_dev_password;SslMode=Disable;Pooling=false"
  },
  
  "QuestDb": {
    "HttpEndpoint": "http://localhost:9000",
    "PgWireEndpoint": "localhost:8812",
    "TableName": "point_data",
    "AutoFlushIntervalMs": 1000,
    "AutoFlushRows": 10000
  },
  
  "Redis": {
    "ConnectionString": "localhost:6379",
    "CurrentValueTtlSeconds": 3600,
    "IdempotencyTtlSeconds": 86400
  },
  
  "Kafka": {
    "BootstrapServers": "localhost:9092",
    "DataPointsTopic": "naia.datapoints",
    "BackfillTopic": "naia.datapoints.backfill",
    "DlqTopic": "naia.datapoints.dlq",
    "ConsumerGroupId": "naia-historians",
    "ProducerClientId": "naia-api-producer",
    "ConsumerClientIdPrefix": "naia-consumer",
    "SessionTimeoutMs": 30000,
    "HeartbeatIntervalMs": 10000,
    "MaxPollIntervalMs": 300000,
    "DataPointsPartitions": 12,
    "ReplicationFactor": 1
  },
  
  "Pipeline": {
    "PollTimeoutMs": 1000,
    "RetryDelayMs": 1000,
    "MaxBatchSize": 10000,
    "FlushIntervalMs": 1000
  },
  
  "PIWebApi": {
    "Enabled": false,
    "UseAfSdk": false,
    "BaseUrl": "http://localhost",
    "DataArchive": "dummy",
    "AfServer": "occafsrvr01",
    "UseWindowsAuth": true,
    "Username": null,
    "Password": null,
    "TimeoutSeconds": 30,
    "MaxConcurrentRequests": 10
  },
  
  "WeatherApi": {
    "Enabled": false,
    "EnableAutoDiscovery": true,
    "BaseUrl": "https://api.open-meteo.com/v1",
    "PollingIntervalMs": 300000,
    "TimeoutSeconds": 30,
    "Locations": [
      "52.5,-0.5"
    ],
    "MaxDiscoveredPoints": 500,
    "Variables": [
      "temperature_2m",
      "relative_humidity_2m",
      "dew_point_2m",
      "pressure_msl",
      "wind_speed_10m",
      "wind_direction_10m",
      "wind_gusts_10m",
      "precipitation",
      "cloud_cover"
    ]
  },
  
  "EiaGrid": {
    "Enabled": false,
    "ApiKey": "",
    "BaseUrl": "https://api.eia.gov/v2",
    "PollingIntervalMs": 900000,
    "TimeoutSeconds": 30,
    "MaxPointsPerRequest": 5000,
    "Series": [
      {
        "Route": "electricity/rto/region-data",
        "SeriesId": "EBA.CISO-ALL.D.H",
        "FriendlyName": "CAISO Demand"
      },
      {
        "Route": "electricity/rto/region-data",
        "SeriesId": "EBA.ERCO-ALL.D.H",
        "FriendlyName": "ERCOT Demand"
      },
      {
        "Route": "electricity/rto/region-data",
        "SeriesId": "EBA.MISO-ALL.D.H",
        "FriendlyName": "MISO Demand"
      },
      {
        "Route": "electricity/rto/region-data",
        "SeriesId": "EBA.NYIS-ALL.D.H",
        "FriendlyName": "NYISO Demand"
      },
      {
        "Route": "electricity/rto/region-data",
        "SeriesId": "EBA.PJM-ALL.D.H",
        "FriendlyName": "PJM Demand"
      }
    ]
  },

  "WindFarmReplay": {
    "Enabled": true,
    "AutoStart": true,
    "DataDirectory": "/opt/naia/data/kelmarsh/scada_2019",
    "SiteCode": "KSH",
    "SiteName": "Kelmarsh Wind Farm",
    "TurbineCount": 6,
    "SpeedMultiplier": 60.0,
    "DataIntervalMinutes": 10,
    "BatchSize": 1000,
    "LoopReplay": true,
    "SkipNaN": true,
    "DataYears": [2019],
    "IncludedReadings": [
      "WindSpeed",
      "Power",
      "WindDirection",
      "RotorRPM",
      "GeneratorRPM",
      "PitchA",
      "PitchB",
      "PitchC",
      "NacelleTemp",
      "GearOilTemp",
      "GenBearingFrontTemp",
      "GenBearingRearTemp",
      "AmbientTemp",
      "GridVoltage",
      "GridFrequency"
    ],
    "KafkaTopic": "naia.datapoints"
  },

  "PatternFlywheel": {
    "Enabled": true,
    "Hangfire": {
      "EnableDashboard": true,
      "DashboardPath": "/hangfire",
      "WorkerCount": 5,
      "BehavioralAnalysisCron": "*/5 * * * *",
      "CorrelationAnalysisCron": "*/15 * * * *",
      "ClusterDetectionCron": "5/15 * * * *",
      "PatternMatchingCron": "10/15 * * * *",
      "PatternLearningCron": "0 * * * *",
      "MaintenanceCron": "0 3 * * *"
    },
    "BehavioralAggregator": {
      "MinSamplesForBehavior": 50,
      "WindowHours": 24,
      "BatchSize": 100,
      "CacheTtlHours": 48
    },
    "CorrelationProcessor": {
      "MinCorrelation": 0.60,
      "WindowHours": 168,
      "MinSamples": 100,
      "CacheTtlHours": 24
    },
    "ClusterDetection": {
      "Algorithm": "Louvain",
      "MinClusterSize": 3,
      "MaxClusterSize": 50,
      "MinCohesion": 0.50,
      "DbscanEpsilon": 0.3,
      "DbscanMinPoints": 3
    },
    "PatternMatching": {
      "MinConfidenceForSuggestion": 0.50,
      "NamingWeight": 0.30,
      "CorrelationWeight": 0.40,
      "RangeWeight": 0.20,
      "RateWeight": 0.10,
      "MaxSuggestionsPerCluster": 5
    },
    "PatternLearning": {
      "ConfidenceIncreasePerApproval": 0.05,
      "ConfidenceDecreasePerRejection": 0.03,
      "ConfidenceDecayPerDay": 0.005,
      "MinConfidenceFloor": 0.30,
      "MaxPatternsPerTenant": 1000,
      "MinPointsForPattern": 5,
      "InitialPatternConfidence": 0.60
    },
    "Maintenance": {
      "RetentionDays": 90
    }
  }
}
