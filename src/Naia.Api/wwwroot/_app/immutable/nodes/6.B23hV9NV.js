import{d as Be,f as p,a as i,s as j,c as J}from"../chunks/kWLYM50S.js";import{p as Re,d as _,l as K,o as Ve,G as Ie,g as e,f as R,t as D,a as Ne,s as v,c as s,r,n as Oe,b as n,H as Ze}from"../chunks/FfWx4iUs.js";import{i as u}from"../chunks/BpnB5xfV.js";import{e as W,i as X,s as ve}from"../chunks/TdKr0dpg.js";import{r as qe}from"../chunks/Ba1hZZVp.js";import{s as Ee}from"../chunks/C4XQzUGN.js";import{b as Fe}from"../chunks/BDu2iqcD.js";import{b as Ge}from"../chunks/B4T80sUb.js";import{i as Qe}from"../chunks/Bn9PLWWT.js";import{i as Ue,j as Je}from"../chunks/8Sjc7fTO.js";var Ke=p('<span class="inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium text-white"> <button class="ml-1 hover:bg-white/20 rounded-full p-0.5"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></span>'),We=p('<div class="p-4 text-center text-gray-500"><svg class="w-5 h-5 animate-spin mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg></div>'),Xe=p('<div class="text-xs text-gray-500 truncate"> </div>'),Ye=p('<button class="w-full px-3 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"><div class="font-mono text-sm"> </div> <!></button>'),$e=p('<div class="p-4 text-center text-gray-500 text-sm">No tags found</div>'),et=p('<div class="p-4 text-center text-gray-500 text-sm">Type to search for tags</div>'),tt=p('<div class="absolute top-full left-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-10"><div class="p-2"><input type="text" class="input" placeholder="Search tags..."/></div> <div class="max-h-60 overflow-y-auto"><!></div></div>'),at=p('<div class="relative"><button class="inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm border-2 border-dashed border-gray-300 dark:border-gray-600 text-gray-500 hover:border-naia-500 hover:text-naia-500 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"></path></svg> Add Tag</button> <!></div>'),rt=p("<button> </button>"),st=p('<div class="absolute inset-0 flex items-center justify-center bg-gray-900/50 z-10"><div class="flex items-center gap-2 text-gray-400"><svg class="w-5 h-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Loading data...</div></div>'),ot=p('<div class="flex flex-col items-center justify-center h-96 text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 mb-4 opacity-50"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"></path></svg> <p class="text-lg font-medium">No tags selected</p> <p class="text-sm">Click "Add Tag" above to select historian points to trend</p></div>'),it=p('<div class="fixed inset-0 z-0"></div>'),lt=p('<div class="space-y-6"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Trend Viewer</h1> <p class="text-gray-500 dark:text-gray-400">Compare multiple historian tags over time</p></div></div> <div class="card p-4"><div class="flex flex-wrap items-start gap-4"><div class="flex-1 min-w-[300px]"><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> </label> <div class="flex flex-wrap gap-2 min-h-[40px]"><!> <!></div></div> <div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Time Range</label> <div class="flex gap-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1"></div></div></div></div> <div class="card overflow-hidden"><div class="relative"><!> <!> <div></div></div></div> <div class="text-sm text-gray-500 dark:text-gray-400"><p>ðŸ’¡ <strong>Tips:</strong> Use mouse wheel to zoom, drag to pan. Click legend items to show/hide series.</p></div></div> <!>',1);function xt(pe,fe){Re(fe,!0);let P,c=null,V=_(!1),I=_(!1),y=_(""),L=_(K([])),l=_(K([])),w=_(!1);const Y=[{label:"1 Hour",hours:1},{label:"8 Hours",hours:8},{label:"24 Hours",hours:24},{label:"7 Days",hours:168},{label:"30 Days",hours:720}];let x=_(K(Y[2]));const H=["#14b8a6","#3b82f6","#f59e0b","#ef4444","#8b5cf6","#10b981","#f97316","#ec4899"];async function ge(){if(!e(y).trim()){n(L,[],!0);return}n(I,!0);try{const t=await Je({tagName:e(y),take:20});n(L,t.data.filter(a=>a.pointSequenceId&&!e(l).find(o=>o.id===a.id)),!0)}catch(t){console.error("Search failed:",t)}finally{n(I,!1)}}function ue(t){e(l).length>=8||(n(l,[...e(l),t],!0),n(y,""),n(L,[],!0),n(w,!1),N())}function me(t){n(l,e(l).filter(a=>a.id!==t.id),!0),N()}async function N(){if(e(l).length===0||!c){c==null||c.clear();return}n(V,!0);try{const t=new Date,a=new Date(t.getTime()-e(x).hours*60*60*1e3),o=e(l).map(g=>Ue(g.id,a,t,2e3).catch(()=>null)),d=await Promise.all(o);he(d,e(l))}catch(t){console.error("Failed to load chart data:",t)}finally{n(V,!1)}}function he(t,a){if(!c)return;const o=[],d=[];t.forEach((m,k)=>{if(!m)return;const C=a[k],z=H[k%H.length];d.push(C.name),o.push({name:C.name,type:"line",data:m.data.map(M=>[new Date(M.timestamp).getTime(),M.value]),smooth:!1,symbol:"none",lineStyle:{color:z,width:2},emphasis:{lineStyle:{width:3}}})});const g={backgroundColor:"transparent",legend:{data:d,textStyle:{color:"#9ca3af"},top:0,type:"scroll"},grid:{left:60,right:40,top:40,bottom:60},tooltip:{trigger:"axis",backgroundColor:"rgba(17, 24, 39, 0.95)",borderColor:"rgba(75, 85, 99, 0.5)",textStyle:{color:"#f3f4f6"},axisPointer:{type:"cross",label:{backgroundColor:"#374151"}}},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}},iconStyle:{borderColor:"#9ca3af"}},xAxis:{type:"time",axisLine:{lineStyle:{color:"#374151"}},axisLabel:{color:"#9ca3af"},splitLine:{show:!1}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#374151"}},axisLabel:{color:"#9ca3af"},splitLine:{lineStyle:{color:"#1f2937"}}},dataZoom:[{type:"inside",start:0,end:100},{type:"slider",start:0,end:100,height:20,bottom:10}],series:o};c.setOption(g,!0)}Ve(()=>{c=Qe(P,"dark");const t=new ResizeObserver(()=>{c==null||c.resize()});return t.observe(P),()=>{t.disconnect(),c==null||c.dispose()}}),Ie(()=>{e(x)&&e(l).length>0&&N()});var $=lt(),O=R($),Z=v(s(O),2),ee=s(Z),q=s(ee),E=s(q),xe=s(E);r(E);var te=v(E,2),ae=s(te);W(ae,17,()=>e(l),X,(t,a,o)=>{var d=Ke(),g=s(d),m=v(g);m.__click=()=>me(e(a)),r(d),D(()=>{Ee(d,`background-color: ${H[o%H.length]??""}`),j(g,`${e(a).name??""} `)}),i(t,d)});var be=v(ae,2);{var _e=t=>{var a=at(),o=s(a);o.__click=()=>n(w,!e(w));var d=v(o,2);{var g=m=>{var k=tt(),C=s(k),z=s(C);qe(z),z.__input=ge,Ze(z),r(C);var M=v(C,2),ze=s(M);{var Se=h=>{var B=We();i(h,B)},Te=h=>{var B=J(),Le=R(B);{var Me=S=>{var A=J(),F=R(A);W(F,17,()=>e(L),X,(G,T)=>{var f=Ye();f.__click=()=>ue(e(T));var b=s(f),je=s(b,!0);r(b);var De=v(b,2);{var Pe=Q=>{var U=Xe(),He=s(U,!0);r(U),D(()=>j(He,e(T).description)),i(Q,U)};u(De,Q=>{e(T).description&&Q(Pe)})}r(f),D(()=>j(je,e(T).name)),i(G,f)}),i(S,A)},Ae=S=>{var A=J(),F=R(A);{var G=f=>{var b=$e();i(f,b)},T=f=>{var b=et();i(f,b)};u(F,f=>{e(y)?f(G):f(T,!1)},!0)}i(S,A)};u(Le,S=>{e(L).length>0?S(Me):S(Ae,!1)},!0)}i(h,B)};u(ze,h=>{e(I)?h(Se):h(Te,!1)})}r(M),r(k),Fe(z,()=>e(y),h=>n(y,h)),i(m,k)};u(d,m=>{e(w)&&m(g)})}r(a),i(t,a)};u(be,t=>{e(l).length<8&&t(_e)})}r(te),r(q);var re=v(q,2),se=v(s(re),2);W(se,21,()=>Y,X,(t,a)=>{var o=rt();let d;o.__click=()=>n(x,e(a),!0);var g=s(o,!0);r(o),D(()=>{d=ve(o,1,"px-3 py-1.5 text-sm rounded-md transition-colors whitespace-nowrap",null,d,{"bg-naia-500":e(x)===e(a),"text-white":e(x)===e(a),"text-gray-600":e(x)!==e(a),"dark:text-gray-400":e(x)!==e(a)}),j(g,e(a).label)}),i(t,o)}),r(se),r(re),r(ee),r(Z);var oe=v(Z,2),ie=s(oe),le=s(ie);{var ye=t=>{var a=st();i(t,a)};u(le,t=>{e(V)&&t(ye)})}var ne=v(le,2);{var we=t=>{var a=ot();i(t,a)};u(ne,t=>{e(l).length===0&&t(we)})}var de=v(ne,2);let ce;Ge(de,t=>P=t,()=>P),r(ie),r(oe),Oe(2),r(O);var ke=v(O,2);{var Ce=t=>{var a=it();a.__click=()=>n(w,!1),i(t,a)};u(ke,t=>{e(w)&&t(Ce)})}D(()=>{j(xe,`Selected Tags (${e(l).length??""}/8)`),ce=ve(de,1,"w-full h-96",null,ce,{invisible:e(l).length===0})}),i(pe,$),Ne()}Be(["click","input"]);export{xt as component};
