import{d as qt,f as g,s as _,a as n,c as et}from"../chunks/Dyrg4-m5.js";import{p as Rt,d as b,l as at,o as Ut,O as pe,g as t,c as r,s,b as d,r as e,t as j,a as Qt,f as U,a6 as Ft,n as Bt}from"../chunks/CMoxswSl.js";import{i as z}from"../chunks/DBwLsdZZ.js";import{e as rt,s as fe,i as st}from"../chunks/CoZh60iV.js";import{r as Ht,s as Ot}from"../chunks/1tFsSi7w.js";import{b as be,a as me}from"../chunks/Cw-6wO0J.js";import{b as xe}from"../chunks/CcUDQLtG.js";import{i as he,j as ye,n as we,o as ke}from"../chunks/8Sjc7fTO.js";import{b as Se}from"../chunks/BJTlkxqz.js";import{i as Ce,L as De}from"../chunks/Bn9PLWWT.js";var Le=g("<button> </button>"),ze=g('<div class="absolute inset-0 flex items-center justify-center bg-gray-900/50 rounded-lg z-10"><div class="flex items-center gap-2 text-gray-400"><svg class="w-5 h-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Loading data...</div></div>'),Te=g('<div class="absolute inset-0 flex items-center justify-center bg-gray-900/50 rounded-lg z-10"><div class="text-red-400"> </div></div>'),Ae=g('<div class="space-y-4"><div class="flex items-center gap-2"><span class="text-sm text-gray-500 dark:text-gray-400">Time Range:</span> <div class="flex gap-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1"></div></div> <div class="relative"><!> <!> <div class="w-full h-64 rounded-lg bg-gray-900/50"></div></div></div>');function Pe(it,I){Rt(I,!0);let T,m=null,C=b(!0),M=b(null);const E=[{label:"1H",hours:1},{label:"8H",hours:8},{label:"24H",hours:24},{label:"7D",hours:168}];let k=b(at(E[0]));async function H(){d(C,!0),d(M,null);try{const i=new Date,v=new Date(i.getTime()-t(k).hours*60*60*1e3),f=await he(I.pointId,v,i,2e3);Q(f)}catch(i){d(M,i instanceof Error?i.message:"Failed to load data",!0)}finally{d(C,!1)}}function Q(i){if(!m)return;const v=i.data.map(y=>[new Date(y.timestamp).getTime(),y.value]),f={backgroundColor:"transparent",grid:{left:60,right:20,top:20,bottom:40},tooltip:{trigger:"axis",backgroundColor:"rgba(17, 24, 39, 0.9)",borderColor:"rgba(75, 85, 99, 0.5)",textStyle:{color:"#f3f4f6"},formatter:y=>{var G;const V=y[0];return`
						<div class="font-mono">
							<div class="text-gray-400">${new Date(V.data[0]).toLocaleString()}</div>
							<div class="font-bold">${((G=V.data[1])==null?void 0:G.toFixed(2))??"—"} ${I.units||""}</div>
						</div>
					`}},xAxis:{type:"time",axisLine:{lineStyle:{color:"#374151"}},axisLabel:{color:"#9ca3af"},splitLine:{show:!1}},yAxis:{type:"value",name:I.units||"",nameTextStyle:{color:"#9ca3af"},axisLine:{lineStyle:{color:"#374151"}},axisLabel:{color:"#9ca3af"},splitLine:{lineStyle:{color:"#1f2937"}}},series:[{name:I.pointName,type:"line",data:v,smooth:!1,symbol:"none",lineStyle:{color:"#14b8a6",width:2},areaStyle:{color:new De(0,0,0,1,[{offset:0,color:"rgba(20, 184, 166, 0.3)"},{offset:1,color:"rgba(20, 184, 166, 0)"}])}}],dataZoom:[{type:"inside",start:0,end:100}]};m.setOption(f)}Ut(()=>{m=Ce(T,"dark"),H();const i=new ResizeObserver(()=>{m==null||m.resize()});return i.observe(T),()=>{i.disconnect(),m==null||m.dispose()}}),pe(()=>{t(k)&&m&&H()});var p=Ae(),D=r(p),L=s(r(D),2);rt(L,21,()=>E,st,(i,v)=>{var f=Le();let y;f.__click=()=>d(k,t(v),!0);var V=r(f,!0);e(f),j(()=>{y=fe(f,1,"px-3 py-1 text-sm rounded-md transition-colors",null,y,{"bg-naia-500":t(k)===t(v),"text-white":t(k)===t(v),"text-gray-600":t(k)!==t(v),"dark:text-gray-400":t(k)!==t(v)}),_(V,t(v).label)}),n(i,f)}),e(L),e(D);var h=s(D,2),F=r(h);{var ot=i=>{var v=ze();n(i,v)};z(F,i=>{t(C)&&i(ot)})}var K=s(F,2);{var O=i=>{var v=Te(),f=r(v),y=r(f,!0);e(f),e(v),j(()=>_(y,t(M))),n(i,v)};z(K,i=>{t(M)&&i(O)})}var nt=s(K,2);Se(nt,i=>T=i,()=>T),e(h),e(p),n(it,p),Qt()}qt(["click"]);var je=g("<option> </option>"),Me=g('<div class="p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400"> </div>'),Ve=g('<tr><td><div class="skeleton h-4 w-48"></div></td><td><div class="skeleton h-4 w-32"></div></td><td><div class="skeleton h-4 w-16"></div></td><td><div class="skeleton h-4 w-12"></div></td><td><div class="skeleton h-4 w-16"></div></td><td><div class="skeleton h-4 w-16"></div></td><td></td></tr>'),Ne=g('<tr><td colspan="7" class="text-center py-8 text-gray-500">No points found matching your criteria</td></tr>'),Ie=g('<div class="text-xs text-gray-400"> </div>'),Ee=g('<div class="font-mono tabular-nums"> </div> <div class="text-xs text-gray-400"> </div>',1),Fe=g('<span class="text-gray-400">Loading...</span>'),Be=g('<span class="text-gray-400">Not synced</span>'),He=g('<span class="badge badge-success">Enabled</span>'),Oe=g('<span class="badge badge-neutral">Disabled</span>'),qe=g('<tr class="group"><td><div class="font-mono text-sm font-medium text-gray-900 dark:text-gray-100"> </div> <!></td><td class="max-w-[200px] truncate"> </td><td><!></td><td> </td><td><span class="badge badge-neutral"> </span></td><td><!></td><td class="text-right"><button class="btn btn-ghost btn-sm opacity-0 group-hover:opacity-100 transition-opacity"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"></path></svg> Trend</button></td></tr>'),Re=g('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"><div class="bg-white dark:bg-gray-900 rounded-xl shadow-2xl w-full max-w-4xl m-4 max-h-[90vh] overflow-hidden"><div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800"><div><h3 class="font-semibold text-gray-900 dark:text-gray-100"> </h3> <p class="text-sm text-gray-500"> </p></div> <button class="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4"><!></div></div></div>'),Ue=g('<div class="space-y-6"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Point Browser</h1> <p class="text-gray-500 dark:text-gray-400">Search and manage historian tags</p></div> <span class="text-sm text-gray-500"> </span></div> <div class="card p-4"><div class="flex flex-wrap gap-4"><div class="flex-1 min-w-[200px]"><label for="search" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Search Tags</label> <div class="relative"><input type="text" id="search" class="input pl-10" placeholder="Filter by tag name..."/> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></div></div> <div class="w-48"><label for="datasource" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Source</label> <select id="datasource" class="input"><option>All Sources</option><!></select></div> <div class="flex items-end"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-naia-500 focus:ring-naia-500"/> <span class="text-sm text-gray-700 dark:text-gray-300">Enabled only</span></label></div> <div class="flex items-end"><button class="btn btn-primary">Search</button></div></div></div> <!> <div class="card overflow-hidden"><div class="table-container"><table class="table"><thead><tr><th>Tag Name</th><th>Description</th><th>Current Value</th><th>Units</th><th>Data Type</th><th>Status</th><th class="text-right">Actions</th></tr></thead><tbody><!></tbody></table></div> <div class="flex items-center justify-between px-4 py-3 border-t border-gray-200 dark:border-gray-800"><div class="text-sm text-gray-500"> </div> <div class="flex gap-2"><button class="btn btn-secondary btn-sm">Previous</button> <button class="btn btn-secondary btn-sm">Next</button></div></div></div></div> <!>',1);function ea(it,I){Rt(I,!0);let T=b(at([])),m=b(at([])),C=b(0),M=b(!0),E=b(null),k=b(""),H=b(""),Q=b(!1),p=b(0);const D=25;let L=b(at({})),h=b(null);async function F(){d(M,!0),d(E,null);try{const a=await ye({tagName:t(k)||void 0,dataSourceId:t(H)||void 0,enabled:t(Q)?!0:void 0,skip:t(p)*D,take:D});d(T,a.data,!0),d(C,a.total,!0),K()}catch(a){d(E,a instanceof Error?a.message:"Failed to load points",!0)}finally{d(M,!1)}}async function ot(){try{d(m,await ke(),!0)}catch(a){console.error("Failed to load data sources:",a)}}async function K(){for(const a of t(T))if(a.pointSequenceId)try{const o=await we(a.id);t(L)[a.id]={value:o.value,timestamp:o.timestamp}}catch{t(L)[a.id]=null}d(L,{...t(L)},!0)}function O(){d(p,0),F()}function nt(){(t(p)+1)*D<t(C)&&(Ft(p),F())}function i(){t(p)>0&&(Ft(p,-1),F())}function v(a){return a==null?"—":typeof a=="number"?a.toFixed(2):String(a)}function f(a){return new Date(a).toLocaleTimeString()}Ut(()=>{ot(),F()});var y=Ue(),V=U(y),W=r(V),G=s(r(W),2),Gt=r(G);e(G),e(W);var dt=s(W,2),Ct=r(dt),lt=r(Ct),Dt=s(r(lt),2),vt=r(Dt);Ht(vt),vt.__keydown=a=>a.key==="Enter"&&O(),Bt(2),e(Dt),e(lt);var ct=s(lt,2),X=s(r(ct),2);X.__change=O;var ut=r(X);ut.value=ut.__value="";var Zt=s(ut);rt(Zt,17,()=>t(m),st,(a,o)=>{var c=je(),A=r(c,!0);e(c);var P={};j(()=>{_(A,t(o).name),P!==(P=t(o).id)&&(c.value=(c.__value=t(o).id)??"")}),n(a,c)}),e(X),e(ct);var gt=s(ct,2),Lt=r(gt),_t=r(Lt);Ht(_t),_t.__change=O,Bt(2),e(Lt),e(gt);var zt=s(gt,2),Jt=r(zt);Jt.__click=O,e(zt),e(Ct),e(dt);var Tt=s(dt,2);{var Kt=a=>{var o=Me(),c=r(o,!0);e(o),j(()=>_(c,t(E))),n(a,o)};z(Tt,a=>{t(E)&&a(Kt)})}var At=s(Tt,2),pt=r(At),Pt=r(pt),jt=s(r(Pt)),Wt=r(jt);{var Xt=a=>{var o=et(),c=U(o);rt(c,16,()=>Array(5),st,(A,P)=>{var w=Ve();n(A,w)}),n(a,o)},Yt=a=>{var o=et(),c=U(o);{var A=w=>{var q=Ne();n(w,q)},P=w=>{var q=et(),Y=U(q);rt(Y,17,()=>t(T),st,(mt,l)=>{var R=qe(),Z=r(R),J=r(Z),ae=r(J,!0);e(J);var re=s(J,2);{var se=u=>{var x=Ie(),B=r(x,!0);e(x),j(()=>_(B,t(l).sourceAddress)),n(u,x)};z(re,u=>{t(l).sourceAddress&&t(l).sourceAddress!==t(l).name&&u(se)})}e(Z);var $=s(Z),ie=r($,!0);e($);var xt=s($),oe=r(xt);{var ne=u=>{var x=Ee(),B=U(x),St=r(B,!0);e(B);var tt=s(B,2),N=r(tt,!0);e(tt),j((S,_e)=>{_(St,S),_(N,_e)},[()=>{var S;return v((S=t(L)[t(l).id])==null?void 0:S.value)},()=>{var S;return f(((S=t(L)[t(l).id])==null?void 0:S.timestamp)??"")}]),n(u,x)},de=u=>{var x=et(),B=U(x);{var St=N=>{var S=Fe();n(N,S)},tt=N=>{var S=Be();n(N,S)};z(B,N=>{t(l).pointSequenceId?N(St):N(tt,!1)},!0)}n(u,x)};z(oe,u=>{t(L)[t(l).id]?u(ne):u(de,!1)})}e(xt);var ht=s(xt),le=r(ht,!0);e(ht);var yt=s(ht),It=r(yt),ve=r(It,!0);e(It),e(yt);var wt=s(yt),ce=r(wt);{var ue=u=>{var x=He();n(u,x)},ge=u=>{var x=Oe();n(u,x)};z(ce,u=>{t(l).enabled?u(ue):u(ge,!1)})}e(wt);var Et=s(wt),kt=r(Et);kt.__click=()=>d(h,t(l),!0),e(Et),e(R),j(()=>{_(ae,t(l).name),Ot($,"title",t(l).description),_(ie,t(l).description||"—"),_(le,t(l).engineeringUnits||"—"),_(ve,t(l).dataType),kt.disabled=!t(l).pointSequenceId,Ot(kt,"title",t(l).pointSequenceId?"View trend":"Point not synced to time-series")}),n(mt,R)}),n(w,q)};z(c,w=>{t(T).length===0?w(A):w(P,!1)},!0)}n(a,o)};z(Wt,a=>{t(M)?a(Xt):a(Yt,!1)})}e(jt),e(Pt),e(pt);var Mt=s(pt,2),ft=r(Mt),$t=r(ft);e(ft);var Vt=s(ft,2),bt=r(Vt);bt.__click=i;var Nt=s(bt,2);Nt.__click=nt,e(Vt),e(Mt),e(At),e(V);var te=s(V,2);{var ee=a=>{var o=Re();o.__click=()=>d(h,null);var c=r(o);c.__click=J=>J.stopPropagation();var A=r(c),P=r(A),w=r(P),q=r(w,!0);e(w);var Y=s(w,2),mt=r(Y,!0);e(Y),e(P);var l=s(P,2);l.__click=()=>d(h,null),e(A);var R=s(A,2),Z=r(R);Pe(Z,{get pointId(){return t(h).id},get pointName(){return t(h).name},get units(){return t(h).engineeringUnits}}),e(R),e(c),e(o),j(()=>{_(q,t(h).name),_(mt,t(h).description||"No description")}),n(a,o)};z(te,a=>{t(h)&&a(ee)})}j((a,o,c)=>{_(Gt,`${a??""} points total`),_($t,`Showing ${t(p)*D+1} to ${o??""} of ${c??""}`),bt.disabled=t(p)===0,Nt.disabled=(t(p)+1)*D>=t(C)},[()=>t(C).toLocaleString(),()=>Math.min((t(p)+1)*D,t(C)),()=>t(C).toLocaleString()]),be(vt,()=>t(k),a=>d(k,a)),xe(X,()=>t(H),a=>d(H,a)),me(_t,()=>t(Q),a=>d(Q,a)),n(it,y),Qt()}qt(["keydown","change","click"]);export{ea as component};
