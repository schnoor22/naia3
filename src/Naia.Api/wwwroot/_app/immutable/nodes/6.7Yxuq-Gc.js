import{d as It,f as g,s as _,a as n,c as at}from"../chunks/Dyrg4-m5.js";import{p as Ot,d as b,l as et,o as Rt,O as _a,g as t,c as r,s,b as d,r as a,t as P,a as Ut,f as q,a6 as Ft,n as Bt}from"../chunks/CMoxswSl.js";import{i as z}from"../chunks/DBwLsdZZ.js";import{e as rt,s as pa,i as st}from"../chunks/CoZh60iV.js";import{r as Ht,s as fa}from"../chunks/1tFsSi7w.js";import{b as ba,a as ma}from"../chunks/Cw-6wO0J.js";import{b as xa}from"../chunks/CcUDQLtG.js";import{i as ha,j as ya,n as wa,o as ka}from"../chunks/8Sjc7fTO.js";import{b as Sa}from"../chunks/BJTlkxqz.js";import{i as Ca,L as Da}from"../chunks/Bn9PLWWT.js";var La=g("<button> </button>"),za=g('<div class="absolute inset-0 flex items-center justify-center bg-gray-900/50 rounded-lg z-10"><div class="flex items-center gap-2 text-gray-400"><svg class="w-5 h-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Loading data...</div></div>'),Ta=g('<div class="absolute inset-0 flex items-center justify-center bg-gray-900/50 rounded-lg z-10"><div class="text-red-400"> </div></div>'),Aa=g('<div class="space-y-4"><div class="flex items-center gap-2"><span class="text-sm text-gray-500 dark:text-gray-400">Time Range:</span> <div class="flex gap-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1"></div></div> <div class="relative"><!> <!> <div class="w-full h-64 rounded-lg bg-gray-900/50"></div></div></div>');function ja(it,E){Ot(E,!0);let T,m=null,C=b(!0),M=b(null);const F=[{label:"1H",hours:1},{label:"8H",hours:8},{label:"24H",hours:24},{label:"7D",hours:168}];let k=b(et(F[1]));async function I(){d(C,!0),d(M,null);try{const i=new Date,l=new Date(i.getTime()-t(k).hours*60*60*1e3),f=await ha(E.pointId,l,i,2e3);Q(f)}catch(i){d(M,i instanceof Error?i.message:"Failed to load data",!0)}finally{d(C,!1)}}function Q(i){if(!m)return;const l=i.data.map(y=>[new Date(y.timestamp).getTime(),y.value]),f={backgroundColor:"transparent",grid:{left:60,right:20,top:20,bottom:40},tooltip:{trigger:"axis",backgroundColor:"rgba(17, 24, 39, 0.9)",borderColor:"rgba(75, 85, 99, 0.5)",textStyle:{color:"#f3f4f6"},formatter:y=>{var G;const V=y[0];return`
						<div class="font-mono">
							<div class="text-gray-400">${new Date(V.data[0]).toLocaleString()}</div>
							<div class="font-bold">${((G=V.data[1])==null?void 0:G.toFixed(2))??"—"} ${E.units||""}</div>
						</div>
					`}},xAxis:{type:"time",axisLine:{lineStyle:{color:"#374151"}},axisLabel:{color:"#9ca3af"},splitLine:{show:!1}},yAxis:{type:"value",name:E.units||"",nameTextStyle:{color:"#9ca3af"},axisLine:{lineStyle:{color:"#374151"}},axisLabel:{color:"#9ca3af"},splitLine:{lineStyle:{color:"#1f2937"}}},series:[{name:E.pointName,type:"line",data:l,smooth:!1,symbol:"none",lineStyle:{color:"#14b8a6",width:2},areaStyle:{color:new Da(0,0,0,1,[{offset:0,color:"rgba(20, 184, 166, 0.3)"},{offset:1,color:"rgba(20, 184, 166, 0)"}])}}],dataZoom:[{type:"inside",start:0,end:100}]};m.setOption(f)}Rt(()=>{m=Ca(T,"dark"),I();const i=new ResizeObserver(()=>{m==null||m.resize()});return i.observe(T),()=>{i.disconnect(),m==null||m.dispose()}}),_a(()=>{t(k)&&m&&I()});var p=Aa(),D=r(p),L=s(r(D),2);rt(L,21,()=>F,st,(i,l)=>{var f=La();let y;f.__click=()=>d(k,t(l),!0);var V=r(f,!0);a(f),P(()=>{y=pa(f,1,"px-3 py-1 text-sm rounded-md transition-colors",null,y,{"bg-naia-500":t(k)===t(l),"text-white":t(k)===t(l),"text-gray-600":t(k)!==t(l),"dark:text-gray-400":t(k)!==t(l)}),_(V,t(l).label)}),n(i,f)}),a(L),a(D);var h=s(D,2),B=r(h);{var ot=i=>{var l=za();n(i,l)};z(B,i=>{t(C)&&i(ot)})}var K=s(B,2);{var O=i=>{var l=Ta(),f=r(l),y=r(f,!0);a(f),a(l),P(()=>_(y,t(M))),n(i,l)};z(K,i=>{t(M)&&i(O)})}var nt=s(K,2);Sa(nt,i=>T=i,()=>T),a(h),a(p),n(it,p),Ut()}It(["click"]);var Pa=g("<option> </option>"),Ma=g('<div class="p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400"> </div>'),Va=g('<tr><td><div class="skeleton h-4 w-48"></div></td><td><div class="skeleton h-4 w-32"></div></td><td><div class="skeleton h-4 w-16"></div></td><td><div class="skeleton h-4 w-12"></div></td><td><div class="skeleton h-4 w-16"></div></td><td><div class="skeleton h-4 w-16"></div></td><td></td></tr>'),Na=g('<tr><td colspan="7" class="text-center py-8 text-gray-500">No points found matching your criteria</td></tr>'),Ea=g('<div class="text-xs text-gray-400"> </div>'),Fa=g('<div class="font-mono tabular-nums"> </div> <div class="text-xs text-gray-400"> </div>',1),Ba=g('<span class="text-gray-400">Loading...</span>'),Ha=g('<span class="text-gray-400">Not synced</span>'),Ia=g('<span class="badge badge-success">Enabled</span>'),Oa=g('<span class="badge badge-neutral">Disabled</span>'),Ra=g('<tr class="group"><td><div class="font-mono text-sm font-medium text-gray-900 dark:text-gray-100"> </div> <!></td><td class="max-w-[200px] truncate"> </td><td><!></td><td> </td><td><span class="badge badge-neutral"> </span></td><td><!></td><td class="text-right"><button class="btn btn-ghost btn-sm opacity-0 group-hover:opacity-100 transition-opacity" title="View 8-hour trend"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"></path></svg> Trend</button></td></tr>'),Ua=g('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"><div class="bg-white dark:bg-gray-900 rounded-xl shadow-2xl w-full max-w-4xl m-4 max-h-[90vh] overflow-hidden"><div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800"><div><h3 class="font-semibold text-gray-900 dark:text-gray-100"> </h3> <p class="text-sm text-gray-500"> </p></div> <button class="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4"><!></div></div></div>'),qa=g('<div class="space-y-6"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Point Browser</h1> <p class="text-gray-500 dark:text-gray-400">Search and manage historian tags</p></div> <span class="text-sm text-gray-500"> </span></div> <div class="card p-4"><div class="flex flex-wrap gap-4"><div class="flex-1 min-w-[200px]"><label for="search" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Search Tags</label> <div class="relative"><input type="text" id="search" class="input pl-10" placeholder="Filter by tag name..."/> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></div></div> <div class="w-48"><label for="datasource" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Source</label> <select id="datasource" class="input"><option>All Sources</option><!></select></div> <div class="flex items-end"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-naia-500 focus:ring-naia-500"/> <span class="text-sm text-gray-700 dark:text-gray-300">Enabled only</span></label></div> <div class="flex items-end"><button class="btn btn-primary">Search</button></div></div></div> <!> <div class="card overflow-hidden"><div class="table-container"><table class="table"><thead><tr><th>Tag Name</th><th>Description</th><th>Current Value</th><th>Units</th><th>Data Type</th><th>Status</th><th class="text-right">Actions</th></tr></thead><tbody><!></tbody></table></div> <div class="flex items-center justify-between px-4 py-3 border-t border-gray-200 dark:border-gray-800"><div class="text-sm text-gray-500"> </div> <div class="flex gap-2"><button class="btn btn-secondary btn-sm">Previous</button> <button class="btn btn-secondary btn-sm">Next</button></div></div></div></div> <!>',1);function ae(it,E){Ot(E,!0);let T=b(et([])),m=b(et([])),C=b(0),M=b(!0),F=b(null),k=b(""),I=b(""),Q=b(!1),p=b(0);const D=25;let L=b(et({})),h=b(null);async function B(){d(M,!0),d(F,null);try{const e=await ya({tagName:t(k)||void 0,dataSourceId:t(I)||void 0,enabled:t(Q)?!0:void 0,skip:t(p)*D,take:D});d(T,e.data,!0),d(C,e.total,!0),K()}catch(e){d(F,e instanceof Error?e.message:"Failed to load points",!0)}finally{d(M,!1)}}async function ot(){try{d(m,await ka(),!0)}catch(e){console.error("Failed to load data sources:",e)}}async function K(){for(const e of t(T))if(e.pointSequenceId)try{const o=await wa(e.id);t(L)[e.id]={value:o.value,timestamp:o.timestamp}}catch{t(L)[e.id]=null}d(L,{...t(L)},!0)}function O(){d(p,0),B()}function nt(){(t(p)+1)*D<t(C)&&(Ft(p),B())}function i(){t(p)>0&&(Ft(p,-1),B())}function l(e){return e==null?"—":typeof e=="number"?e.toFixed(2):String(e)}function f(e){return new Date(e).toLocaleTimeString()}Rt(()=>{ot(),B()});var y=qa(),V=q(y),W=r(V),G=s(r(W),2),qt=r(G);a(G),a(W);var dt=s(W,2),St=r(dt),lt=r(St),Ct=s(r(lt),2),vt=r(Ct);Ht(vt),vt.__keydown=e=>e.key==="Enter"&&O(),Bt(2),a(Ct),a(lt);var ct=s(lt,2),X=s(r(ct),2);X.__change=O;var ut=r(X);ut.value=ut.__value="";var Qt=s(ut);rt(Qt,17,()=>t(m),st,(e,o)=>{var v=Pa(),A=r(v,!0);a(v);var j={};P(()=>{_(A,t(o).name),j!==(j=t(o).id)&&(v.value=(v.__value=t(o).id)??"")}),n(e,v)}),a(X),a(ct);var gt=s(ct,2),Dt=r(gt),_t=r(Dt);Ht(_t),_t.__change=O,Bt(2),a(Dt),a(gt);var Lt=s(gt,2),Gt=r(Lt);Gt.__click=O,a(Lt),a(St),a(dt);var zt=s(dt,2);{var Zt=e=>{var o=Ma(),v=r(o,!0);a(o),P(()=>_(v,t(F))),n(e,o)};z(zt,e=>{t(F)&&e(Zt)})}var Tt=s(zt,2),pt=r(Tt),At=r(pt),jt=s(r(At)),Jt=r(jt);{var Kt=e=>{var o=at(),v=q(o);rt(v,16,()=>Array(5),st,(A,j)=>{var w=Va();n(A,w)}),n(e,o)},Wt=e=>{var o=at(),v=q(o);{var A=w=>{var R=Na();n(w,R)},j=w=>{var R=at(),Y=q(R);rt(Y,17,()=>t(T),st,(mt,c)=>{var U=Ra(),Z=r(U),J=r(Z),ta=r(J,!0);a(J);var aa=s(J,2);{var ea=u=>{var x=Ea(),H=r(x,!0);a(x),P(()=>_(H,t(c).sourceAddress)),n(u,x)};z(aa,u=>{t(c).sourceAddress&&t(c).sourceAddress!==t(c).name&&u(ea)})}a(Z);var $=s(Z),ra=r($,!0);a($);var xt=s($),sa=r(xt);{var ia=u=>{var x=Fa(),H=q(x),kt=r(H,!0);a(H);var tt=s(H,2),N=r(tt,!0);a(tt),P((S,ga)=>{_(kt,S),_(N,ga)},[()=>{var S;return l((S=t(L)[t(c).id])==null?void 0:S.value)},()=>{var S;return f(((S=t(L)[t(c).id])==null?void 0:S.timestamp)??"")}]),n(u,x)},oa=u=>{var x=at(),H=q(x);{var kt=N=>{var S=Ba();n(N,S)},tt=N=>{var S=Ha();n(N,S)};z(H,N=>{t(c).pointSequenceId?N(kt):N(tt,!1)},!0)}n(u,x)};z(sa,u=>{t(L)[t(c).id]?u(ia):u(oa,!1)})}a(xt);var ht=s(xt),na=r(ht,!0);a(ht);var yt=s(ht),Nt=r(yt),da=r(Nt,!0);a(Nt),a(yt);var wt=s(yt),la=r(wt);{var va=u=>{var x=Ia();n(u,x)},ca=u=>{var x=Oa();n(u,x)};z(la,u=>{t(c).isEnabled?u(va):u(ca,!1)})}a(wt);var Et=s(wt),ua=r(Et);ua.__click=()=>d(h,t(c),!0),a(Et),a(U),P(()=>{_(ta,t(c).name),fa($,"title",t(c).description),_(ra,t(c).description||"—"),_(na,t(c).engineeringUnits||"—"),_(da,t(c).valueType)}),n(mt,U)}),n(w,R)};z(v,w=>{t(T).length===0?w(A):w(j,!1)},!0)}n(e,o)};z(Jt,e=>{t(M)?e(Kt):e(Wt,!1)})}a(jt),a(At),a(pt);var Pt=s(pt,2),ft=r(Pt),Xt=r(ft);a(ft);var Mt=s(ft,2),bt=r(Mt);bt.__click=i;var Vt=s(bt,2);Vt.__click=nt,a(Mt),a(Pt),a(Tt),a(V);var Yt=s(V,2);{var $t=e=>{var o=Ua();o.__click=()=>d(h,null);var v=r(o);v.__click=J=>J.stopPropagation();var A=r(v),j=r(A),w=r(j),R=r(w,!0);a(w);var Y=s(w,2),mt=r(Y,!0);a(Y),a(j);var c=s(j,2);c.__click=()=>d(h,null),a(A);var U=s(A,2),Z=r(U);ja(Z,{get pointId(){return t(h).id},get pointName(){return t(h).name},get units(){return t(h).engineeringUnits}}),a(U),a(v),a(o),P(()=>{_(R,t(h).name),_(mt,t(h).description||"No description")}),n(e,o)};z(Yt,e=>{t(h)&&e($t)})}P((e,o,v)=>{_(qt,`${e??""} points total`),_(Xt,`Showing ${t(p)*D+1} to ${o??""} of ${v??""}`),bt.disabled=t(p)===0,Vt.disabled=(t(p)+1)*D>=t(C)},[()=>t(C).toLocaleString(),()=>Math.min((t(p)+1)*D,t(C)),()=>t(C).toLocaleString()]),ba(vt,()=>t(k),e=>d(k,e)),xa(X,()=>t(I),e=>d(I,e)),ma(_t,()=>t(Q),e=>d(Q,e)),n(it,y),Ut()}It(["keydown","change","click"]);export{ae as component};
