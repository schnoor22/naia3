import{d as Rt,f as v,a as l,c as ut,b as V,s as f}from"../chunks/kWLYM50S.js";import{p as zt,o as At,c as r,s as i,t as T,g as a,a as Lt,b as y,d as U,u as z,r as s,n as tt,f as at}from"../chunks/FfWx4iUs.js";import{i as x}from"../chunks/BpnB5xfV.js";import{e as et,i as st,s as Vt}from"../chunks/TdKr0dpg.js";import{r as Nt,s as Ht}from"../chunks/Ba1hZZVp.js";import{b as Wt}from"../chunks/BDu2iqcD.js";import{S as _t,M as ft}from"../chunks/CZYw4wec.js";import{d as Kt,g as Yt,c as qt,s as Gt,a as Jt}from"../chunks/8Sjc7fTO.js";import{t as L}from"../chunks/DpakSfzu.js";var Ot=V('<svg class="w-4 h-4 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>'),Qt=V('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"></path></svg>'),Xt=v('<button class="btn btn-danger"><!> Stop Ingestion</button>'),Zt=V('<svg class="w-4 h-4 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>'),$t=V('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"></path></svg>'),ta=v('<button class="btn btn-success"><!> Start Ingestion</button>'),aa=v('<div class="skeleton h-6 w-full"></div>'),ea=v('<div class="space-y-4"></div>'),sa=v('<span class="badge badge-success">Running</span>'),ra=v('<span class="badge badge-neutral">Stopped</span>'),ia=v('<dl class="space-y-4"><div class="flex justify-between"><dt class="text-gray-500 dark:text-gray-400">Status</dt> <dd><!></dd></div> <div class="flex justify-between"><dt class="text-gray-500 dark:text-gray-400">Poll Interval</dt> <dd class="font-mono"> </dd></div> <div class="flex justify-between"><dt class="text-gray-500 dark:text-gray-400">Last Poll</dt> <dd class="font-mono text-sm"> </dd></div> <div class="flex justify-between"><dt class="text-gray-500 dark:text-gray-400">Errors</dt> <dd> </dd></div></dl>'),oa=v('<p class="text-gray-500">Unable to load pipeline status</p>'),da=v('<div class="skeleton h-6 w-full"></div>'),la=v('<div class="space-y-4"></div>'),na=v('<span class="badge badge-success">Yes</span>'),va=v('<span class="badge badge-danger">No</span>'),ca=v('<dl class="space-y-4"><div class="flex justify-between"><dt class="text-gray-500 dark:text-gray-400">Connector Type</dt> <dd> </dd></div> <div class="flex justify-between"><dt class="text-gray-500 dark:text-gray-400">Connected</dt> <dd><!></dd></div> <div class="flex justify-between"><dt class="text-gray-500 dark:text-gray-400">Response Time</dt> <dd class="font-mono"> </dd></div> <div class="flex justify-between"><dt class="text-gray-500 dark:text-gray-400">Message</dt> <dd class="text-sm text-right max-w-[200px] truncate"> </dd></div></dl>'),ga=v('<p class="text-gray-500">Unable to connect to PI System</p>'),pa=V('<svg class="w-4 h-4 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>'),ua=v('<tr><td class="font-mono text-sm"> </td><td class="max-w-[200px] truncate"> </td><td> </td><td><span class="badge badge-neutral"> </span></td></tr>'),_a=v('<div class="text-sm text-gray-500 mb-3"> </div> <div class="table-container max-h-64 overflow-y-auto"><table class="table"><thead class="sticky top-0"><tr><th>Tag Name</th><th>Description</th><th>Units</th><th>Type</th></tr></thead><tbody></tbody></table></div>',1),fa=v('<p class="text-gray-500 text-center py-8">Enter a filter pattern and click "Discover Points" to search PI Server</p>'),ya=v('<div class="space-y-6"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Ingestion Control</h1> <p class="text-gray-500 dark:text-gray-400">Manage PI System data collection</p></div> <div class="flex items-center gap-3"><!></div></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><!> <!> <!> <!></div> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="card"><div class="card-header"><h2 class="font-semibold text-gray-900 dark:text-gray-100">Pipeline Details</h2></div> <div class="card-body"><!></div></div> <div class="card"><div class="card-header"><h2 class="font-semibold text-gray-900 dark:text-gray-100">PI System Connection</h2></div> <div class="card-body"><!></div></div></div> <div class="card"><div class="card-header"><h2 class="font-semibold text-gray-900 dark:text-gray-100">PI Point Discovery</h2></div> <div class="card-body"><div class="flex gap-4 mb-4"><input type="text" class="input flex-1" placeholder="Filter pattern (e.g., *BESS*, *MW*)"/> <button class="btn btn-primary"><!> Discover Points</button></div> <!></div></div></div>');function Ca(yt,xt){zt(xt,!0);let c=U(null),m=U(null),C=U(!0),P=U(null),q=U("*BESS*"),A=U(null),N=U(!1);async function H(){try{const[t,e]=await Promise.all([Yt().catch(()=>null),qt().catch(()=>null)]);y(c,t,!0),y(m,e,!0)}catch(t){console.error("Failed to load status:",t)}finally{y(C,!1)}}async function ht(){y(P,"start");try{await Jt(),L.add({type:"success",title:"Ingestion Started",message:"PI â†’ Kafka pipeline is now running"}),await H()}catch(t){L.add({type:"error",title:"Failed to start",message:t instanceof Error?t.message:"Unknown error"})}finally{y(P,null)}}async function mt(){y(P,"stop");try{await Gt(),L.add({type:"info",title:"Ingestion Stopped",message:"Pipeline has been stopped"}),await H()}catch(t){L.add({type:"error",title:"Failed to stop",message:t instanceof Error?t.message:"Unknown error"})}finally{y(P,null)}}async function rt(){y(N,!0);try{y(A,await Kt(a(q),100),!0)}catch(t){L.add({type:"error",title:"Discovery failed",message:t instanceof Error?t.message:"Unknown error"})}finally{y(N,!1)}}At(()=>{H();const t=setInterval(H,5e3);return()=>clearInterval(t)});var G=ya(),J=r(G),it=i(r(J),2),bt=r(it);{var wt=t=>{var e=Xt();e.__click=mt;var o=r(e);{var _=d=>{var n=Ot();l(d,n)},g=d=>{var n=Qt();l(d,n)};x(o,d=>{a(P)==="stop"?d(_):d(g,!1)})}tt(),s(e),T(()=>e.disabled=!!a(P)),l(t,e)},kt=t=>{var e=ta();e.__click=ht;var o=r(e);{var _=d=>{var n=Zt();l(d,n)},g=d=>{var n=$t();l(d,n)};x(o,d=>{a(P)==="start"?d(_):d(g,!1)})}tt(),s(e),T(()=>e.disabled=!!a(P)),l(t,e)};x(bt,t=>{var e;(e=a(c))!=null&&e.isRunning?t(wt):t(kt,!1)})}s(it),s(J);var O=i(J,2),ot=r(O);{let t=z(()=>{var o;return(o=a(c))!=null&&o.isRunning?"healthy":"degraded"}),e=z(()=>{var o;return(o=a(c))!=null&&o.isRunning?"Streaming data":"Stopped"});_t(ot,{get status(){return a(t)},title:"Pipeline Status",get subtitle(){return a(e)},icon:"ðŸ“¡",get loading(){return a(C)}})}var dt=i(ot,2);{let t=z(()=>{var o;return(o=a(m))!=null&&o.connected?"healthy":"unhealthy"}),e=z(()=>{var o;return((o=a(m))==null?void 0:o.message)||"Unknown"});_t(dt,{get status(){return a(t)},title:"PI Connection",get subtitle(){return a(e)},icon:"ðŸ­",get loading(){return a(C)}})}var lt=i(dt,2);{let t=z(()=>{var e;return((e=a(c))==null?void 0:e.pointsConfigured)??"â€”"});ft(lt,{title:"Points Configured",get value(){return a(t)},icon:"ðŸ“Š",get loading(){return a(C)}})}var St=i(lt,2);{let t=z(()=>{var e,o;return((o=(e=a(c))==null?void 0:e.messagesPublished)==null?void 0:o.toLocaleString())??"â€”"});ft(St,{title:"Messages Published",get value(){return a(t)},icon:"ðŸ“¨",get loading(){return a(C)}})}s(O);var Q=i(O,2),X=r(Q),nt=i(r(X),2),Pt=r(nt);{var It=t=>{var e=ea();et(e,20,()=>Array(4),st,(o,_)=>{var g=aa();l(o,g)}),s(e),l(t,e)},Ct=t=>{var e=ut(),o=at(e);{var _=d=>{var n=ia(),b=r(n),h=i(r(b),2),M=r(h);{var w=u=>{var $=sa();l(u,$)},B=u=>{var $=ra();l(u,$)};x(M,u=>{a(c).isRunning?u(w):u(B,!1)})}s(h),s(b);var k=i(b,2),F=i(r(k),2),j=r(F);s(F),s(k);var S=i(k,2),I=i(r(S),2),R=r(I,!0);s(I),s(S);var D=i(S,2),E=i(r(D),2);let Y;var p=r(E,!0);s(E),s(D),s(n),T(u=>{f(j,`${a(c).pollInterval??""}ms`),f(R,u),Y=Vt(E,1,"",null,Y,{"text-red-500":a(c).errors>0,"text-emerald-500":a(c).errors===0}),f(p,a(c).errors)},[()=>a(c).lastPollTime?new Date(a(c).lastPollTime).toLocaleString():"Never"]),l(d,n)},g=d=>{var n=oa();l(d,n)};x(o,d=>{a(c)?d(_):d(g,!1)},!0)}l(t,e)};x(Pt,t=>{a(C)?t(It):t(Ct,!1)})}s(nt),s(X);var vt=i(X,2),ct=i(r(vt),2),Mt=r(ct);{var jt=t=>{var e=la();et(e,20,()=>Array(4),st,(o,_)=>{var g=da();l(o,g)}),s(e),l(t,e)},Dt=t=>{var e=ut(),o=at(e);{var _=d=>{var n=ca(),b=r(n),h=i(r(b),2),M=r(h,!0);s(h),s(b);var w=i(b,2),B=i(r(w),2),k=r(B);{var F=p=>{var u=na();l(p,u)},j=p=>{var u=va();l(p,u)};x(k,p=>{a(m).connected?p(F):p(j,!1)})}s(B),s(w);var S=i(w,2),I=i(r(S),2),R=r(I);s(I),s(S);var D=i(S,2),E=i(r(D),2),Y=r(E,!0);s(E),s(D),s(n),T(p=>{f(M,a(m).connectorType||"Web API"),f(R,`${p??""}ms`),Ht(E,"title",a(m).message),f(Y,a(m).message||"â€”")},[()=>{var p;return((p=a(m).responseTimeMs)==null?void 0:p.toFixed(0))??"â€”"}]),l(d,n)},g=d=>{var n=ga();l(d,n)};x(o,d=>{a(m)?d(_):d(g,!1)},!0)}l(t,e)};x(Mt,t=>{a(C)?t(jt):t(Dt,!1)})}s(ct),s(vt),s(Q);var gt=i(Q,2),pt=i(r(gt),2),Z=r(pt),W=r(Z);Nt(W),W.__keydown=t=>t.key==="Enter"&&rt();var K=i(W,2);K.__click=rt;var Et=r(K);{var Tt=t=>{var e=pa();l(t,e)};x(Et,t=>{a(N)&&t(Tt)})}tt(),s(K),s(Z);var Ut=i(Z,2);{var Bt=t=>{var e=_a(),o=at(e),_=r(o);s(o);var g=i(o,2),d=r(g),n=i(r(d));et(n,21,()=>a(A).points,st,(b,h)=>{var M=ua(),w=r(M),B=r(w,!0);s(w);var k=i(w),F=r(k,!0);s(k);var j=i(k),S=r(j,!0);s(j);var I=i(j),R=r(I),D=r(R,!0);s(R),s(I),s(M),T(()=>{f(B,a(h).SourceAddress),f(F,a(h).Description||"â€”"),f(S,a(h).EngineeringUnits||"â€”"),f(D,a(h).PointType)}),l(b,M)}),s(n),s(d),s(g),T(()=>f(_,`Found ${a(A).count??""} points matching "${a(A).filter??""}"`)),l(t,e)},Ft=t=>{var e=fa();l(t,e)};x(Ut,t=>{a(A)?t(Bt):t(Ft,!1)})}s(pt),s(gt),s(G),T(()=>K.disabled=a(N)),Wt(W,()=>a(q),t=>y(q,t)),l(yt,G),Lt()}Rt(["click","keydown"]);export{Ca as component};
