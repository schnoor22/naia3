import{d as Ut,f as p,s as h,a as l,c as rt}from"../chunks/kWLYM50S.js";import{U as me,J as xe,A as he,aj as ye,ak as we,al as ke,W as Lt,X as Se,p as Gt,d as S,l as st,o as Qt,G as Ce,g as t,c as r,s,b as v,r as e,t as N,a as Wt,f as G,am as Bt,n as Ht}from"../chunks/FfWx4iUs.js";import{i as M}from"../chunks/BpnB5xfV.js";import{e as it,s as Le,i as nt}from"../chunks/TdKr0dpg.js";import{r as Ot,s as Rt}from"../chunks/Ba1hZZVp.js";import{b as De,a as ze}from"../chunks/BDu2iqcD.js";import{i as Ae,j as Te,n as je,o as Pe}from"../chunks/8Sjc7fTO.js";import{b as Me}from"../chunks/B4T80sUb.js";import{i as qe,L as Ve}from"../chunks/Bn9PLWWT.js";function Jt(i,c,y=!1){if(i.multiple){if(c==null)return;if(!ye(c))return we();for(var d of i.options)d.selected=c.includes(Z(d));return}for(d of i.options){var m=Z(d);if(ke(m,c)){d.selected=!0;return}}(!y||c!==void 0)&&(i.selectedIndex=-1)}function Ie(i){var c=new MutationObserver(()=>{Jt(i,i.__value)});c.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),he(()=>{c.disconnect()})}function Ne(i,c,y=c){var d=new WeakSet,m=!0;me(i,"change",x=>{var L=x?"[selected]":":checked",f;if(i.multiple)f=[].map.call(i.querySelectorAll(L),Z);else{var q=i.querySelector(L)??i.querySelector("option:not([disabled])");f=q&&Z(q)}y(f),Lt!==null&&d.add(Lt)}),xe(()=>{var x=c();if(i===document.activeElement){var L=Se??Lt;if(d.has(L))return}if(Jt(i,x,m),m&&x===void 0){var f=i.querySelector(":checked");f!==null&&(x=Z(f),y(x))}i.__value=x,m=!1}),Ie(i)}function Z(i){return"__value"in i?i.__value:i.value}var Ee=p("<button> </button>"),Fe=p('<div class="absolute inset-0 flex items-center justify-center bg-gray-900/50 rounded-lg z-10"><div class="flex items-center gap-2 text-gray-400"><svg class="w-5 h-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Loading data...</div></div>'),Be=p('<div class="absolute inset-0 flex items-center justify-center bg-gray-900/50 rounded-lg z-10"><div class="text-red-400"> </div></div>'),He=p('<div class="space-y-4"><div class="flex items-center gap-2"><span class="text-sm text-gray-500 dark:text-gray-400">Time Range:</span> <div class="flex gap-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1"></div></div> <div class="relative"><!> <!> <div class="w-full h-64 rounded-lg bg-gray-900/50"></div></div></div>');function Oe(i,c){Gt(c,!0);let y,d=null,m=S(!0),x=S(null);const L=[{label:"1H",hours:1},{label:"8H",hours:8},{label:"24H",hours:24},{label:"7D",hours:168}];let f=S(st(L[0]));async function q(){v(m,!0),v(x,null);try{const n=new Date,_=new Date(n.getTime()-t(f).hours*60*60*1e3),k=await Ae(c.pointId,_,n,2e3);Q(k)}catch(n){v(x,n instanceof Error?n.message:"Failed to load data",!0)}finally{v(m,!1)}}function Q(n){if(!d)return;const _=n.data.map(z=>[new Date(z.timestamp).getTime(),z.value]),k={backgroundColor:"transparent",grid:{left:60,right:20,top:20,bottom:40},tooltip:{trigger:"axis",backgroundColor:"rgba(17, 24, 39, 0.9)",borderColor:"rgba(75, 85, 99, 0.5)",textStyle:{color:"#f3f4f6"},formatter:z=>{var W;const E=z[0];return`
						<div class="font-mono">
							<div class="text-gray-400">${new Date(E.data[0]).toLocaleString()}</div>
							<div class="font-bold">${((W=E.data[1])==null?void 0:W.toFixed(2))??"—"} ${c.units||""}</div>
						</div>
					`}},xAxis:{type:"time",axisLine:{lineStyle:{color:"#374151"}},axisLabel:{color:"#9ca3af"},splitLine:{show:!1}},yAxis:{type:"value",name:c.units||"",nameTextStyle:{color:"#9ca3af"},axisLine:{lineStyle:{color:"#374151"}},axisLabel:{color:"#9ca3af"},splitLine:{lineStyle:{color:"#1f2937"}}},series:[{name:c.pointName,type:"line",data:_,smooth:!1,symbol:"none",lineStyle:{color:"#14b8a6",width:2},areaStyle:{color:new Ve(0,0,0,1,[{offset:0,color:"rgba(20, 184, 166, 0.3)"},{offset:1,color:"rgba(20, 184, 166, 0)"}])}}],dataZoom:[{type:"inside",start:0,end:100}]};d.setOption(k)}Qt(()=>{d=qe(y,"dark"),q();const n=new ResizeObserver(()=>{d==null||d.resize()});return n.observe(y),()=>{n.disconnect(),d==null||d.dispose()}}),Ce(()=>{t(f)&&d&&q()});var w=He(),j=r(w),P=s(r(j),2);it(P,21,()=>L,nt,(n,_)=>{var k=Ee();let z;k.__click=()=>v(f,t(_),!0);var E=r(k,!0);e(k),N(()=>{z=Le(k,1,"px-3 py-1 text-sm rounded-md transition-colors",null,z,{"bg-naia-500":t(f)===t(_),"text-white":t(f)===t(_),"text-gray-600":t(f)!==t(_),"dark:text-gray-400":t(f)!==t(_)}),h(E,t(_).label)}),l(n,k)}),e(P),e(j);var D=s(j,2),B=r(D);{var ot=n=>{var _=Fe();l(n,_)};M(B,n=>{t(m)&&n(ot)})}var K=s(B,2);{var O=n=>{var _=Be(),k=r(_),z=r(k,!0);e(k),e(_),N(()=>h(z,t(x))),l(n,_)};M(K,n=>{t(x)&&n(O)})}var dt=s(K,2);Me(dt,n=>y=n,()=>y),e(D),e(w),l(i,w),Wt()}Ut(["click"]);var Re=p("<option> </option>"),Ue=p('<div class="p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400"> </div>'),Ge=p('<tr><td><div class="skeleton h-4 w-48"></div></td><td><div class="skeleton h-4 w-32"></div></td><td><div class="skeleton h-4 w-16"></div></td><td><div class="skeleton h-4 w-12"></div></td><td><div class="skeleton h-4 w-16"></div></td><td><div class="skeleton h-4 w-16"></div></td><td></td></tr>'),Qe=p('<tr><td colspan="7" class="text-center py-8 text-gray-500">No points found matching your criteria</td></tr>'),We=p('<div class="text-xs text-gray-400"> </div>'),Je=p('<div class="font-mono tabular-nums"> </div> <div class="text-xs text-gray-400"> </div>',1),Xe=p('<span class="text-gray-400">Loading...</span>'),Ze=p('<span class="text-gray-400">Not synced</span>'),Ke=p('<span class="badge badge-success">Enabled</span>'),Ye=p('<span class="badge badge-neutral">Disabled</span>'),$e=p('<tr class="group"><td><div class="font-mono text-sm font-medium text-gray-900 dark:text-gray-100"> </div> <!></td><td class="max-w-[200px] truncate"> </td><td><!></td><td> </td><td><span class="badge badge-neutral"> </span></td><td><!></td><td class="text-right"><button class="btn btn-ghost btn-sm opacity-0 group-hover:opacity-100 transition-opacity"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"></path></svg> Trend</button></td></tr>'),ta=p('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"><div class="bg-white dark:bg-gray-900 rounded-xl shadow-2xl w-full max-w-4xl m-4 max-h-[90vh] overflow-hidden"><div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800"><div><h3 class="font-semibold text-gray-900 dark:text-gray-100"> </h3> <p class="text-sm text-gray-500"> </p></div> <button class="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4"><!></div></div></div>'),ea=p('<div class="space-y-6"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Point Browser</h1> <p class="text-gray-500 dark:text-gray-400">Search and manage historian tags</p></div> <span class="text-sm text-gray-500"> </span></div> <div class="card p-4"><div class="flex flex-wrap gap-4"><div class="flex-1 min-w-[200px]"><label for="search" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Search Tags</label> <div class="relative"><input type="text" id="search" class="input pl-10" placeholder="Filter by tag name..."/> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></div></div> <div class="w-48"><label for="datasource" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Source</label> <select id="datasource" class="input"><option>All Sources</option><!></select></div> <div class="flex items-end"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-naia-500 focus:ring-naia-500"/> <span class="text-sm text-gray-700 dark:text-gray-300">Enabled only</span></label></div> <div class="flex items-end"><button class="btn btn-primary">Search</button></div></div></div> <!> <div class="card overflow-hidden"><div class="table-container"><table class="table"><thead><tr><th>Tag Name</th><th>Description</th><th>Current Value</th><th>Units</th><th>Data Type</th><th>Status</th><th class="text-right">Actions</th></tr></thead><tbody><!></tbody></table></div> <div class="flex items-center justify-between px-4 py-3 border-t border-gray-200 dark:border-gray-800"><div class="text-sm text-gray-500"> </div> <div class="flex gap-2"><button class="btn btn-secondary btn-sm">Previous</button> <button class="btn btn-secondary btn-sm">Next</button></div></div></div></div> <!>',1);function ca(i,c){Gt(c,!0);let y=S(st([])),d=S(st([])),m=S(0),x=S(!0),L=S(null),f=S(""),q=S(""),Q=S(!1),w=S(0);const j=25;let P=S(st({})),D=S(null);async function B(){v(x,!0),v(L,null);try{const a=await Te({tagName:t(f)||void 0,dataSourceId:t(q)||void 0,enabled:t(Q)?!0:void 0,skip:t(w)*j,take:j});v(y,a.data,!0),v(m,a.total,!0),K()}catch(a){v(L,a instanceof Error?a.message:"Failed to load points",!0)}finally{v(x,!1)}}async function ot(){try{v(d,await Pe(),!0)}catch(a){console.error("Failed to load data sources:",a)}}async function K(){for(const a of t(y))if(a.pointSequenceId)try{const o=await je(a.id);t(P)[a.id]={value:o.value,timestamp:o.timestamp}}catch{t(P)[a.id]=null}v(P,{...t(P)},!0)}function O(){v(w,0),B()}function dt(){(t(w)+1)*j<t(m)&&(Bt(w),B())}function n(){t(w)>0&&(Bt(w,-1),B())}function _(a){return a==null?"—":typeof a=="number"?a.toFixed(2):String(a)}function k(a){return new Date(a).toLocaleTimeString()}Qt(()=>{ot(),B()});var z=ea(),E=G(z),Y=r(E),W=s(r(Y),2),Xt=r(W);e(W),e(Y);var lt=s(Y,2),Dt=r(lt),vt=r(Dt),zt=s(r(vt),2),ct=r(zt);Ot(ct),ct.__keydown=a=>a.key==="Enter"&&O(),Ht(2),e(zt),e(vt);var ut=s(vt,2),$=s(r(ut),2);$.__change=O;var ft=r($);ft.value=ft.__value="";var Zt=s(ft);it(Zt,17,()=>t(d),nt,(a,o)=>{var g=Re(),V=r(g,!0);e(g);var I={};N(()=>{h(V,t(o).name),I!==(I=t(o).id)&&(g.value=(g.__value=t(o).id)??"")}),l(a,g)}),e($),e(ut);var _t=s(ut,2),At=r(_t),gt=r(At);Ot(gt),gt.__change=O,Ht(2),e(At),e(_t);var Tt=s(_t,2),Kt=r(Tt);Kt.__click=O,e(Tt),e(Dt),e(lt);var jt=s(lt,2);{var Yt=a=>{var o=Ue(),g=r(o,!0);e(o),N(()=>h(g,t(L))),l(a,o)};M(jt,a=>{t(L)&&a(Yt)})}var Pt=s(jt,2),bt=r(Pt),Mt=r(bt),qt=s(r(Mt)),$t=r(qt);{var te=a=>{var o=rt(),g=G(o);it(g,16,()=>Array(5),nt,(V,I)=>{var A=Ge();l(V,A)}),l(a,o)},ee=a=>{var o=rt(),g=G(o);{var V=A=>{var R=Qe();l(A,R)},I=A=>{var R=rt(),tt=G(R);it(tt,17,()=>t(y),nt,(xt,u)=>{var U=$e(),J=r(U),X=r(J),ie=r(X,!0);e(X);var ne=s(X,2);{var oe=b=>{var C=We(),H=r(C,!0);e(C),N(()=>h(H,t(u).sourceAddress)),l(b,C)};M(ne,b=>{t(u).sourceAddress&&t(u).sourceAddress!==t(u).name&&b(oe)})}e(J);var et=s(J),de=r(et,!0);e(et);var ht=s(et),le=r(ht);{var ve=b=>{var C=Je(),H=G(C),Ct=r(H,!0);e(H);var at=s(H,2),F=r(at,!0);e(at),N((T,pe)=>{h(Ct,T),h(F,pe)},[()=>{var T;return _((T=t(P)[t(u).id])==null?void 0:T.value)},()=>{var T;return k(((T=t(P)[t(u).id])==null?void 0:T.timestamp)??"")}]),l(b,C)},ce=b=>{var C=rt(),H=G(C);{var Ct=F=>{var T=Xe();l(F,T)},at=F=>{var T=Ze();l(F,T)};M(H,F=>{t(u).pointSequenceId?F(Ct):F(at,!1)},!0)}l(b,C)};M(le,b=>{t(P)[t(u).id]?b(ve):b(ce,!1)})}e(ht);var yt=s(ht),ue=r(yt,!0);e(yt);var wt=s(yt),Et=r(wt),fe=r(Et,!0);e(Et),e(wt);var kt=s(wt),_e=r(kt);{var ge=b=>{var C=Ke();l(b,C)},be=b=>{var C=Ye();l(b,C)};M(_e,b=>{t(u).enabled?b(ge):b(be,!1)})}e(kt);var Ft=s(kt),St=r(Ft);St.__click=()=>v(D,t(u),!0),e(Ft),e(U),N(()=>{h(ie,t(u).name),Rt(et,"title",t(u).description),h(de,t(u).description||"—"),h(ue,t(u).engineeringUnits||"—"),h(fe,t(u).dataType),St.disabled=!t(u).pointSequenceId,Rt(St,"title",t(u).pointSequenceId?"View trend":"Point not synced to time-series")}),l(xt,U)}),l(A,R)};M(g,A=>{t(y).length===0?A(V):A(I,!1)},!0)}l(a,o)};M($t,a=>{t(x)?a(te):a(ee,!1)})}e(qt),e(Mt),e(bt);var Vt=s(bt,2),pt=r(Vt),ae=r(pt);e(pt);var It=s(pt,2),mt=r(It);mt.__click=n;var Nt=s(mt,2);Nt.__click=dt,e(It),e(Vt),e(Pt),e(E);var re=s(E,2);{var se=a=>{var o=ta();o.__click=()=>v(D,null);var g=r(o);g.__click=X=>X.stopPropagation();var V=r(g),I=r(V),A=r(I),R=r(A,!0);e(A);var tt=s(A,2),xt=r(tt,!0);e(tt),e(I);var u=s(I,2);u.__click=()=>v(D,null),e(V);var U=s(V,2),J=r(U);Oe(J,{get pointId(){return t(D).id},get pointName(){return t(D).name},get units(){return t(D).engineeringUnits}}),e(U),e(g),e(o),N(()=>{h(R,t(D).name),h(xt,t(D).description||"No description")}),l(a,o)};M(re,a=>{t(D)&&a(se)})}N((a,o,g)=>{h(Xt,`${a??""} points total`),h(ae,`Showing ${t(w)*j+1} to ${o??""} of ${g??""}`),mt.disabled=t(w)===0,Nt.disabled=(t(w)+1)*j>=t(m)},[()=>t(m).toLocaleString(),()=>Math.min((t(w)+1)*j,t(m)),()=>t(m).toLocaleString()]),De(ct,()=>t(f),a=>v(f,a)),Ne($,()=>t(q),a=>v(q,a)),ze(gt,()=>t(Q),a=>v(Q,a)),l(i,z),Wt()}Ut(["keydown","change","click"]);export{ca as component};
